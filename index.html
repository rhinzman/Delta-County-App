<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delta County GIS App</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin=""/>
    
    <!-- Leaflet Providers CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-providers@1.13.0/leaflet-providers.css"/>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Delta County GIS Application</h1>
            <p>Interactive map of Delta County, Michigan</p>
        </div>
    </header>
    
    <main>
        <div id="map-container">
            <div id="map"></div>
            
            <!-- Loading indicator -->
            <div id="loading-indicator" class="loading-overlay">
                <div class="spinner"></div>
                <p>Loading map layers...</p>
            </div>
            
            <!-- Info panel -->
            <div id="info-panel" class="info-panel">
                <div class="panel-header">
                </div>
                <div class="panel-content">
                    <p>Click on map features to view details.</p>
                </div>
            </div>
        </div>
    </main>
    
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Delta County GIS Application | Data from Delta County, Michigan</p>
        </div>
    </footer>
    
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
    
    <!-- Leaflet Providers JavaScript -->
    <script src="https://unpkg.com/leaflet-providers@1.13.0/leaflet-providers.js"></script>
    
    <!-- Esri Leaflet - Try multiple CDNs for reliability -->
    <script src="https://cdn.jsdelivr.net/npm/esri-leaflet@3.0.12/dist/esri-leaflet.js" 
            onerror="console.log('Primary CDN failed, trying backup...'); this.onerror=null; this.src='https://unpkg.com/esri-leaflet@3.0.12/dist/esri-leaflet.js';"></script>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" 
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" 
            crossorigin="anonymous"></script>
    
    <!-- Error Checking and Library Validation -->
    <script>
        // Check if required libraries are loaded
        window.addEventListener('load', function() {
            const checks = {
                'Leaflet': typeof L !== 'undefined',
                'Esri Leaflet': typeof L !== 'undefined' && typeof L.esri !== 'undefined',
                'Leaflet Providers': typeof L !== 'undefined' && typeof L.tileLayer.provider !== 'undefined'
            };
            
            console.log('üìö Library Loading Status:');
            Object.keys(checks).forEach(lib => {
                const status = checks[lib] ? '‚úÖ' : '‚ùå';
                console.log(`   ${status} ${lib}: ${checks[lib] ? 'Loaded' : 'Failed'}`);
            });
            
            if (!checks['Esri Leaflet']) {
                console.error('‚ùå Esri Leaflet failed to load! Check console for network errors.');
                alert('Error: Esri Leaflet library failed to load. Please check your internet connection.');
            }
        });
    </script>
    
    <!-- Custom JavaScript -->
    <script src="js/config.js"></script>
    <script src="js/delta-county-service.js"></script>
    <script src="js/delta-county-fallback.js"></script>
    <script src="js/uw-madison-service.js"></script>
    <script src="js/main.js"></script>
</body>
</html>